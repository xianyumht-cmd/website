const performanceAnalyzer={init:function(){window.performance&&window.performance.getEntriesByType?(this.analyzePageLoadPerformance(),this.analyzeResourceLoadPerformance(),this.analyzeDOMStructure(),this.analyzeJavaScriptExecution(),this.provideOptimizationSuggestions()):console.error("æµè§ˆå™¨ä¸æ”¯æŒPerformance APIï¼Œæ— æ³•è¿›è¡Œæ€§èƒ½åˆ†æ")},analyzePageLoadPerformance:function(){console.group("é¡µé¢åŠ è½½æ€§èƒ½åˆ†æ");const o=performance.timing||{};if(0===(o.navigationStart||0))return console.warn("æ— æ³•è·å–é¡µé¢åŠ è½½æ—¶é—´æŒ‡æ ‡"),void console.groupEnd();const e={dnsTime:o.domainLookupEnd-o.domainLookupStart,tcpTime:o.connectEnd-o.connectStart,requestTime:o.responseStart-o.requestStart,downloadTime:o.responseEnd-o.responseStart,domParsingTime:o.domInteractive-o.responseEnd,domContentLoadedTime:o.domContentLoadedEventEnd-o.domContentLoadedEventStart,loadTime:o.loadEventEnd-o.navigationStart};console.log("DNSè§£ææ—¶é—´:",e.dnsTime,"ms"),console.log("TCPè¿æ¥æ—¶é—´:",e.tcpTime,"ms"),console.log("è¯·æ±‚å“åº”æ—¶é—´:",e.requestTime,"ms"),console.log("å†…å®¹ä¸‹è½½æ—¶é—´:",e.downloadTime,"ms"),console.log("DOMè§£ææ—¶é—´:",e.domParsingTime,"ms"),console.log("DOMå†…å®¹åŠ è½½æ—¶é—´:",e.domContentLoadedTime,"ms"),console.log("é¡µé¢å®Œå…¨åŠ è½½æ—¶é—´:",e.loadTime,"ms"),e.loadTime<1e3?console.log("âœ… é¡µé¢åŠ è½½æ€§èƒ½ä¼˜ç§€ (< 1ç§’)"):e.loadTime<2500?console.log("âœ… é¡µé¢åŠ è½½æ€§èƒ½è‰¯å¥½ (< 2.5ç§’)"):e.loadTime<5e3?console.log("âš ï¸ é¡µé¢åŠ è½½æ€§èƒ½ä¸€èˆ¬ (< 5ç§’)"):console.log("âŒ é¡µé¢åŠ è½½æ€§èƒ½è¾ƒå·® (> 5ç§’)"),console.groupEnd()},analyzeResourceLoadPerformance:function(){console.group("èµ„æºåŠ è½½æ€§èƒ½åˆ†æ");const o=performance.getEntriesByType("resource");if(!o||0===o.length)return console.warn("æ— æ³•è·å–èµ„æºåŠ è½½ä¿¡æ¯"),void console.groupEnd();const e={};let n=0;o.forEach(o=>{const t=o.name,l=t.split(".").pop().split("?")[0].toLowerCase();let s="other";["js"].includes(l)?s="script":["css"].includes(l)?s="style":["jpg","jpeg","png","gif","webp","svg"].includes(l)?s="image":["woff","woff2","ttf","otf","eot"].includes(l)&&(s="font"),e[s]||(e[s]=[]);const c=o.transferSize||o.encodedBodySize||0;n+=c,e[s].push({url:t,size:c,duration:o.duration,startTime:o.startTime})}),console.log("èµ„æºæ€»æ•°:",o.length),console.log("èµ„æºæ€»å¤§å°:",Math.round(n/1024),"KB");for(const o in e){const n=e[o],t=n.reduce((o,e)=>o+e.size,0),l=n.length;console.group(`${o} (${l}ä¸ª, ${Math.round(t/1024)}KB)`);const s=[...n].sort((o,e)=>e.duration-o.duration).slice(0,3);s.length>0&&(console.log("åŠ è½½æœ€æ…¢çš„èµ„æº:"),s.forEach(o=>{console.log(`- ${o.url.split("/").pop()}: ${Math.round(o.duration)}ms (${Math.round(o.size/1024)}KB)`)})),console.groupEnd()}console.groupEnd()},analyzeDOMStructure:function(){console.group("DOMç»“æ„åˆ†æ");const o=document.querySelectorAll("*").length;console.log("DOMèŠ‚ç‚¹æ€»æ•°:",o);const e=(o,n=0)=>{if(!o||!o.children)return n;let t=n;for(let l=0;l<o.children.length;l++){const s=e(o.children[l],n+1);t=Math.max(t,s)}return t},n=e(document.documentElement);console.log("DOMæ ‘æ·±åº¦:",n),o>1500?console.log("âŒ DOMèŠ‚ç‚¹æ•°é‡è¿‡å¤š (> 1500)ï¼Œå¯èƒ½å½±å“é¡µé¢æ€§èƒ½"):o>1e3?console.log("âš ï¸ DOMèŠ‚ç‚¹æ•°é‡è¾ƒå¤š (> 1000)ï¼Œå»ºè®®ä¼˜åŒ–"):console.log("âœ… DOMèŠ‚ç‚¹æ•°é‡åˆç† (< 1000)"),n>15?console.log("âŒ DOMæ ‘æ·±åº¦è¿‡å¤§ (> 15)ï¼Œå¯èƒ½å½±å“æ¸²æŸ“æ€§èƒ½"):n>10?console.log("âš ï¸ DOMæ ‘æ·±åº¦è¾ƒå¤§ (> 10)ï¼Œå»ºè®®ä¼˜åŒ–"):console.log("âœ… DOMæ ‘æ·±åº¦åˆç† (< 10)"),console.groupEnd()},analyzeJavaScriptExecution:function(){console.group("JavaScriptæ‰§è¡Œåˆ†æ");const o=document.querySelectorAll("*");let e=0;const n=["click","mouseover","mouseout","keydown","keyup","submit","change","input"];o.forEach(o=>{n.forEach(n=>{if(window.jQuery&&jQuery._data&&jQuery._data(o,"events")){const t=jQuery._data(o,"events");t&&t[n]&&(e+=t[n].length)}o["on"+n]&&e++})}),console.log("ä¼°è®¡çš„äº‹ä»¶ç›‘å¬å™¨æ•°é‡:",e);let t=0;const l=window.setTimeout,s=window.setInterval;window.setTimeout=function(){return t++,l.apply(this,arguments)},window.setInterval=function(){return t++,s.apply(this,arguments)},setTimeout(()=>{window.setTimeout=l,window.setInterval=s,console.log("ä¼°è®¡çš„å®šæ—¶å™¨æ•°é‡:",t),e>100&&console.log("âš ï¸ äº‹ä»¶ç›‘å¬å™¨æ•°é‡è¾ƒå¤š (> 100)ï¼Œå¯èƒ½å½±å“æ€§èƒ½"),t>10&&console.log("âš ï¸ å®šæ—¶å™¨æ•°é‡è¾ƒå¤š (> 10)ï¼Œå¯èƒ½å½±å“æ€§èƒ½")},1e3),console.groupEnd()},provideOptimizationSuggestions:function(){console.group("ä¼˜åŒ–å»ºè®®");navigator.connection&&"4g"===navigator.connection.effectiveType?console.log("âœ… ç½‘ç«™å¯èƒ½ä½¿ç”¨äº†HTTP/2ï¼Œæœ‰åˆ©äºèµ„æºå¹¶è¡ŒåŠ è½½"):console.log("âš ï¸ å»ºè®®ä½¿ç”¨HTTP/2æé«˜èµ„æºåŠ è½½æ•ˆç‡");performance.getEntriesByType("resource").filter(o=>!o.name.includes(window.location.hostname)).length>0?console.log("âœ… ç½‘ç«™ä½¿ç”¨äº†å¤–éƒ¨èµ„æºæˆ–CDN"):console.log("âš ï¸ å»ºè®®ä½¿ç”¨CDNåŠ é€Ÿèµ„æºåŠ è½½");const o=performance.getEntriesByType("resource").filter(o=>0===o.transferSize&&o.encodedBodySize>0);o.length>0?console.log(`âœ… ${o.length}ä¸ªèµ„æºä½¿ç”¨äº†æµè§ˆå™¨ç¼“å­˜`):console.log("âš ï¸ å»ºè®®é…ç½®é€‚å½“çš„ç¼“å­˜ç­–ç•¥"),console.log("ğŸ“ å…¶ä»–ä¼˜åŒ–å»ºè®®:"),console.log("1. ä½¿ç”¨å»¶è¿ŸåŠ è½½(lazy loading)æŠ€æœ¯åŠ è½½éå…³é”®èµ„æº"),console.log("2. è€ƒè™‘ä½¿ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“(SSR)æé«˜é¦–å±åŠ è½½é€Ÿåº¦"),console.log("3. å®ç°å…³é”®CSSå†…è”ï¼Œå‡å°‘æ¸²æŸ“é˜»å¡"),console.log("4. ä¼˜åŒ–ç¬¬ä¸‰æ–¹è„šæœ¬çš„åŠ è½½æ–¹å¼ï¼Œä½¿ç”¨asyncæˆ–deferå±æ€§"),console.log("5. è€ƒè™‘ä½¿ç”¨WebPæ ¼å¼å›¾ç‰‡æ›¿ä»£JPEGå’ŒPNG"),console.log("6. å®ç°èµ„æºé¢„åŠ è½½(preload)å’Œé¢„è¿æ¥(preconnect)"),console.log("7. å‡å°‘é‡å®šå‘æ¬¡æ•°"),console.log("8. ä¼˜åŒ–å­—ä½“åŠ è½½ï¼Œä½¿ç”¨font-displayå±æ€§"),console.log("9. ä½¿ç”¨å†…å®¹åˆ†å‘ç½‘ç»œ(CDN)åŠ é€Ÿèµ„æºåŠ è½½"),console.log("10. å®ç°é€‚å½“çš„èµ„æºåˆ†åŒ…ç­–ç•¥"),console.groupEnd()}};window.addEventListener("load",function(){setTimeout(function(){performanceAnalyzer.init()},1e3)}),window.performanceAnalyzer=performanceAnalyzer,console.log("æ€§èƒ½åˆ†æå·¥å…·å·²åŠ è½½ï¼Œå°†åœ¨é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œåˆ†æ"),console.log("æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡æ‰§è¡Œ performanceAnalyzer.init() æ‰‹åŠ¨è¿è¡Œåˆ†æ");